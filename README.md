# Endless Chronicle

## 1. 概要 (Overview)

Endless Chronicleは、クラシックなJRPGにインスパイアされた、ブラウザベースの放置系RPGです。プレイヤーはキャラクターを育て、パーティを編成し、無限に続くダンジョンを攻略していきます。

## 2. 遊び方 (How to Play)

1.  `src/index.html` をウェブブラウザで開きます。
2.  「ゲーム開始」をクリックして、主人公を作成します。
3.  拠点画面から「ダンジョンへ」を選択し、冒険を開始します。
4.  戦闘はターンベースで進行します。プレイヤーはキャラクターごとに「こうげき」「スキル」「ぼうぎょ」「アイテム」のコマンドを選択します。
5.  戦闘に勝利すると、経験値、ゴールド、アイテムを獲得できます。
6.  キャラクターがレベルアップするとステータスが上昇し、スキルポイント(SP)を獲得できます。SPはキャラクターステータス画面で新しいスキルを習得するために使用できます。
7.  ゲームの進行状況は、拠点画面の「セーブ」から手動で保存できます。

## 3. ゲームシステム仕様 (Game System Specifications)

### 3.1. キャラクター (Characters)

-   **ステータス:**
    -   `HP`: 生命力。0になると戦闘不能。
    -   `MP`: スキル使用時に消費。
    -   `STR`: 物理攻撃力に影響。
    -   `VIT`: 物理防御力に影響。
    -   `INT`: 魔法攻撃力とヒールの回復量に影響。
    -   `MND`: 魔法防御力に影響。
    -   `AGI`: 戦闘時の行動順と回避率に影響。
    -   `LUK`: アイテムドロップ率やクリティカル率に影響。
-   **ジョブ (Jobs):** キャラクターは様々な職業に就くことができ、職業ごとに習得するスキルやステータスの伸びが異なります。
-   **転職 (Job Change):** 特定のレベル条件を満たすと、転職神殿で上位の職業に転職できます。
-   **転生 (Reincarnation):** レベル99に達したキャラクターは、転生の祭壇で転生できます。レベルは1に戻りますが、永続的なボーナスステータスを獲得できます。
-   **種族と特性 (Races & Traits):** 各キャラクターはランダムな種族と特性を持っており、それぞれがステータスに補正を与えます。

### 3.2. 戦闘 (Combat)

-   **ターン制:** AGIが高いキャラクターから順番に行動します。
-   **属性 (Elements):** スキルやモンスターには属性が設定されていることがあります。弱点属性を突くとダメージが1.5倍、耐性があると0.5倍になります。
-   **状態異常 (Status Ailments):** 毒、麻痺、沈黙などの状態異常が存在し、戦闘を不利にします。
-   **HP/MPバー:** 戦闘中、キャラクターのHPとMPはテキストとバーの両方で表示され、値が変動する際にはアニメーションします。

### 3.3. 遠征システム (Expedition System)

-   **概要:** 戦闘に参加していない待機メンバーを遠征に行かせることができます。
-   **報酬:** 遠征時間、キャラクターのレベル、ステータス（STRとINT）に応じてゴールドを獲得できます。
-   **制限:**
    -   遠征中のキャラクターは戦闘メンバーに加えることはできません。
    -   遠征に出せる最大時間は8時間です。
-   **報酬の受け取り:** 拠点画面で遠征状況が確認でき、完了した遠征の報酬を受け取ることができます。

## 4. 技術的な詳細 (Technical Details)

-   **言語:** HTML, CSS, JavaScript (ES6)
-   **ゲームロジック:** すべてのゲームロジックは `src/game.js` に含まれています。
-   **ゲームデータ:** アイテム、スキル、モンスターなどのマスターデータは `src/data/` ディレクトリ内の各 `.js` ファイルで定義されています。
-   **状態管理:** ゲームの全状態は `game.js` 内のグローバルな `gameState` オブジェクトで一元管理されています。
-   **データ永続化:** ゲームのセーブデータはブラウザの `localStorage` にJSON形式で保存されます。

### ゲーム状態オブジェクト (`gameState`) の構造

```javascript
{
    roster: [], // 全キャラクターのオブジェクトを格納する配列
    party: [], // 戦闘メンバーのキャラクターIDを格納する配列
    inventory: {}, // 所持アイテムと個数を格納するオブジェクト
    gold: 100, // 所持ゴールド
    currentScreen: 'title', // 現在表示中の画面ID
    battle: null, // 現在の戦闘状態を格納するオブジェクト
    dungeon: null, // 現在のダンジョン情報を格納するオブジェクト
    gachaRecruit: null, // ガチャで採用待ちのキャラクター情報
    emblems: {}, // 獲得した紋章と個数
    expeditions: {}, // 遠征中のキャラクター情報
    lastHubVisit: null // 最後にハブを訪れた時刻 (オフライン進行用)
}
```

### ダンジョン踏破アニメーション

ダンジョンをクリアすると、リザルト画面で「ダンジョン踏破」というメッセージがアニメーション表示されます。

-   **HTML要素:** `src/index.html` 内の `#dungeon-clear-message`
-   **CSS:** `src/style.css` 内の `@keyframes dungeon-clear-animation` でアニメーションを定義。表示後、自動的にフェードアウトします。
-   **トリガー:** `src/game.js` の `endBattle` 関数内で、ダンジョンの最終階層をクリアした際にトリガーされます。
